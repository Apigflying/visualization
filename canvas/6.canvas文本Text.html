<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<body>
		<canvas id="canvas" width="800" height="500"></canvas>
		<script type="text/javascript">
			var canvas=document.getElementById("canvas");
			var ctx=canvas.getContext('2d');
			canvas.style.border='1px solid red';
			ctx.moveTo(10,10);
			ctx.lineWidth=10;
			ctx.lineCap='round';
			ctx.strokeStyle='greenyellow';
			ctx.lineTo(100,100);
			ctx.stroke();
			ctx.beginPath();
			ctx.lineWidth=5;
			ctx.fillStyle='coral';
			ctx.strokeRect(100,100,60,60);
			ctx.beginPath();
			ctx.arc(130,130,30,0,2*Math.PI);
			ctx.stroke();
			ctx.arc(130,130,25,0,2*Math.PI);
			ctx.fillStyle='red';
			ctx.fill();
			var data=[{
					"value":.2,
					"color":"red",
					"title":"应届生"
				},{
					"value":.3,
					"color":"blue",
					"title":"社会招生"
				},{
					"value":.4,
					"color":"green",
					"title":"老学员推荐"
				},{
					"value":.1,
					"color":"yellow",
					"title":"公开课"
				}
			];
			var beginAngel=-90*Math.PI/180;
			var x0=300,y0=300,r=100;
			for (var i = 0; i < data.length; i++) {
				ctx.beginPath();
				ctx.fillStyle=data[i].color;
				ctx.moveTo(x0,y0);
				var angle=(360*data[i].value)*Math.PI/180;
				var endAngel=beginAngel+angle;
				ctx.arc(x0,y0,r,beginAngel,endAngel);
				ctx.fill();
				ctx.beginPath();
				var textr=beginAngel+(angle+Math.PI)/2;
				console.log(textr*180/Math.PI)
				var textx=x0+Math.sin(textr)*(r+20);
				var texty=y0-Math.cos(textr)*(r+20);
				if(textr > (Math.PI) && textr<(Math.PI*2)){
					ctx.textAlign='end';
				}
				ctx.fillText(data[i].title,textx,texty);
				beginAngel+=angle;
			}
		</script>
	</body>
</html>
